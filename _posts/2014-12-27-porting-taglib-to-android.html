---
layout: post
title: taglib移植到Android下使用的Android.mk文件
tags: [TagLib,Android,Makefile,Porting]
---
<!--break-->
Android没有预置cppunit，所以tests目录下的内容没有编译。<br><br><pre class="brush: text; gutter: true">#<br><br>define my-all-cpp-files-under<br>$(patsubst ./%,%, \\<br>  $(shell cd $(LOCAL_PATH) ; \\<br>          find -L $(1) -name &quot;*.cpp&quot; -and -not -name &quot;.*&quot;) \\<br> )<br>endef<br><br>define my-all-c-files-under<br>$(patsubst ./%,%, \\<br>  $(shell cd $(LOCAL_PATH) ; \\<br>          find -L $(1) -name &quot;*.c&quot; -and -not -name &quot;.*&quot;) \\<br> )<br>endef<br><br>define my-all-dir-under<br>$(patsubst ./%,%, \\<br>  $(shell find -L $(LOCAL_PATH)/$(1) -name &quot;*&quot; -and -not -name &quot;*.*&quot; -type d) \\<br> )<br>endef<br><br># ============================================================<br>LOCAL_PATH:= $(call my-dir)<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br><br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br><br>LOCAL_SRC_FILES :=  $(call my-all-cpp-files-under, \\<br>                         taglib)<br><br>#$(call print-vars, LOCAL_PATH)<br>#$(call print-vars, LOCAL_C_INCLUDES)<br>$(call print-vars, LOCAL_SRC_FILES)<br><br>LOCAL_MODULE := libtag<br>LOCAL_MODULE_CLASS := SHARED_LIBRARIES<br>LOCAL_PRELINK_MODULE := false<br>LOCAL_MODULE_TAGS := optional<br>LOCAL_SHARED_LIBRARIES := libstlport <br>                          <br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br><br>include $(BUILD_SHARED_LIBRARY)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br><br>LOCAL_C_INCLUDES += bindings/c/<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br><br>LOCAL_SRC_FILES :=  bindings/c/tag_c.cpp<br><br>LOCAL_MODULE := libtag_c<br>LOCAL_MODULE_CLASS := SHARED_LIBRARIES<br>LOCAL_PRELINK_MODULE := false<br>LOCAL_MODULE_TAGS := optional<br>LOCAL_SHARED_LIBRARIES := libstlport libtag<br>                          <br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_SHARED_LIBRARY)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         examples)<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br>                         <br>LOCAL_SRC_FILES := \\<br>	examples/tagreader.cpp<br><br>$(call print-vars, LOCAL_SRC_FILES)<br>                         <br>LOCAL_MODULE := taglib-examples-tagreader<br>LOCAL_SHARED_LIBRARIES := libtag libstlport<br><br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_EXECUTABLE)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         examples)<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br>                         <br>LOCAL_SRC_FILES := \\<br>	examples/tagwriter.cpp<br><br>$(call print-vars, LOCAL_SRC_FILES)<br>                         <br>LOCAL_MODULE := taglib-examples-tagwriter<br>LOCAL_SHARED_LIBRARIES := libtag libstlport<br><br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_EXECUTABLE)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         examples)<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br>                         <br>LOCAL_SRC_FILES := \\<br>	examples/tagreader_c.c<br><br>$(call print-vars, LOCAL_SRC_FILES)<br>                         <br>LOCAL_MODULE := taglib-examples-tagreader_c<br>LOCAL_SHARED_LIBRARIES := libtag libstlport libtag_c<br><br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_EXECUTABLE)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         examples)<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br>                         <br>LOCAL_SRC_FILES := \\<br>	examples/strip-id3v1.cpp<br><br>$(call print-vars, LOCAL_SRC_FILES)<br>                         <br>LOCAL_MODULE := taglib-examples-strip-id3v1<br>LOCAL_SHARED_LIBRARIES := libtag libstlport<br><br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_EXECUTABLE)<br><br># ============================================================<br>include $(CLEAR_VARS)<br><br>LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    external/stlport/stlport \\<br>                    bionic \\<br>                    bionic/libc/private<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         examples)<br>LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         taglib)<br>                         <br>LOCAL_SRC_FILES := \\<br>	examples/framelist.cpp<br><br>$(call print-vars, LOCAL_SRC_FILES)<br>                         <br>LOCAL_MODULE := taglib-examples-framelist<br>LOCAL_SHARED_LIBRARIES := libtag libstlport<br><br>LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>include $(BUILD_EXECUTABLE)<br><br>## ============================================================<br>#include $(CLEAR_VARS)<br><br>#LOCAL_C_INCLUDES := $(KERNEL_HEADERS) \\<br>                    #external/stlport/stlport \\<br>                    #bionic \\<br>                    #bionic/libc/private<br>#LOCAL_C_INCLUDES += $(call my-all-dir-under, \\<br>                         #tests)<br><br>#LOCAL_SRC_FILES :=  $(call my-all-cpp-files-under, \\<br>                         #tests)<br><br>#LOCAL_MODULE := test_taglib<br>#LOCAL_PRELINK_MODULE := false<br>#LOCAL_MODULE_TAGS := optional<br>#LOCAL_SHARED_LIBRARIES := taglib libstlport<br><br>#LOCAL_CFLAGS := -Wno-error=non-virtual-dtor -frtti<br>#LOCAL_LDFLAGS := prebuilts/ndk/6/sources/cxx-stl/gnu-libstdc++/libs/armeabi/libstdc++.a <br><br>#include $(BUILD_EXECUTABLE)</pre>
